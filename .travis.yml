sudo: required
matrix:
  include:
  - language: node_js
    node_js: lts/*
    cache:
      directories:
      - node_modules
    before_install:
    - npm install -g firebase-tools
    - cd code/web/
    - npm install
    script:
    - npm test
    after_success:
    - travis_wait 40 npm run build
    - firebase use default --token $FIREBASE_TOKEN
    - travis_wait firebase deploy -m "Travis deploy" --non-interactive --token $FIREBASE_TOKEN
    on:
      branch:
      - dev
      project: kaagapai
  - language: node_js
    node_js: lts/*
    services: mysql
    cache:
      directories:
      - node_modules
    before_install:
    - cd code/api
    - npm install
    script: 'true'
    deploy:
      provider: heroku
      api_key:
        secure:  NXrEDJteordsvlGU1QAY2E61Z1fSFqoT3ysUQ1PTUtH7/1FNlKaZcGSDE9zsUYJG4lFU+0LMIRMxiWrTAMBmGRZJ7GSXiECghUVR/z4pRXcmuHYNQQ1kU1gDfhmYCmY2Oo/HYJrBulM6kKuKhNGW5x2aWUfz7raVHg6o9lLPAfA4EbOrP5fOmkEIMpcnZ3t579AYT62QU6lWbi4W5ykeJYozhGVC8k8f+MhKXq1eofvMMz5315GDwyIhWdH+CNgo1yXironTvnR55WYFKVu3tl8uhPOSm39gV7YWUVF8jh+eXRqNu7JdylhkgC4J+2VoIYJ+9bwP0Fp4CAcbgi1nqCpc3/TiD169fJ8sCjTcCnGGhA+PdyyzQ5TAQsQebOVQUIrxXuZt4N6C1Cd5ilVz9BJj2uL5AOgqbL28MtY5YcXHRcXNQxjg2a7ADEf85iVzuiAWHlDd0xektVkdw5LLs53JznRi96wijdot7q2VrWGbIo4T4HAIh2d1EQo5qKwRt7TYxCoMgUw49Yi4xfKeP8nXlzw9+YWUGMUOyACj93j74tkSvPGcrfR6B9lqG+Z6KUodQKgNV7ASf3SS75Q744bQEHlmKtNTNAoEsmYPrJNM225oIzj+f/QeNWkaUGgfAQuxIuMI15TmGcS9MimJGQBmuxrCmaGxSa0Wu4tzpVk=
      app:
        dev: kaagapai-test
      on:
        repo: JessieMTabilisma/kaagapAI-test
        branches:
          only:
          - dev

