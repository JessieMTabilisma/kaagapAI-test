sudo: required
matrix:
  include:
  - language: node_js
    node_js: lts/*
    cache:
      directories:
      - node_modules
    before_install:
    - npm install -g firebase-tools
    - cd code/web/
    - npm install
    script:
    - npm test
    after_success:
    - travis_wait 40 npm run build
    - firebase use default --token $FIREBASE_TOKEN
    - travis_wait firebase deploy -m "Travis deploy" --non-interactive --token $FIREBASE_TOKEN
    on:
      branch:
      - dev
      project: kaagapai
  - language: node_js
    node_js: lts/*
    services: mysql
    cache:
      directories:
      - node_modules
    before_install:
    - cd code/api
    - npm install
    script: 'true'
    deploy:
      provider: heroku
      api_key:
        secure: qZ2/JTS/OqPiyHCkQWCMlgc3mNNJ6wtfPSizas+WIjv5qN7Dxsrx8AaJlQ9A/Q1eVVOfD1OtFhQwU4Jh3SirZ50p/jswLGUlmIhYwSxEzFwb4IpOo2Nu6JahwfiW7+wsESQla5FPJ+2H8ZTGfW7rIH2/dh3gDmVm6u/33mmHTig1MuPlc+gvUBIRtJ27extbZbYgwzXCUHX1jP6FO+vohibY0Xy67GB2HbazjhA2v+YCL1uCVD9DEKMC+11S2WvxsNXpxkUvaY4iErlQRgR3pGSJbN9AO94rO3BvXxGpGpmxZEvpVUm+yIgDh4VOxmVnzEPperq7hMfxXRzVs8Vg6DitsL1YJDbGXgfmDaFMAwDm8pWAaRTDw96lV8I7R2x38C6glpEV3gjkD4/J1uq9MoFGq1NsrgywqEb93rAn7aExujUelJcDYTjgDV38j/UB9iaEcZjRyy78YLlLj5KeOnHgmM1Sot2TDXHRARseJOb8+4yHiUkn+NNSbwJWG68S/REYrvnMxQRS0GLl+85bDSWHOcQ90QUWfDQbEr/shiCLtdgSlj0SE8FQp/EbdnFD9By7KWw9zJRZq5XlGK0XxSF9vB00erl+GYERUQu+r3Y5geLPrfooi/q1CkqQH4A3Y86VqO0KJ/n9tZpNxe4hnnPVCsnR/hIboQM4KTIGEDQ=
      app:
        dev: kaagapai-test-dev
      on:
        repo: JessieMTabilisma/kaagapAI-test
        branches:
          only:
          - dev

